{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="{% static 'Home/CSS/styles.css' %}">
    <style>
        /* Styles minimaux pour rendre une mise en page proche du prototype */
        .container { max-width:1200px; margin:2rem auto; }
        .grid { display:flex; gap:1.5rem; }
        .col-left { width:320px; background:#f7f7f7; padding:1rem; border-radius:6px; }
        .col-right { flex:1; background:#fff; padding:1rem; border-radius:6px; }
        .tabs { display:flex; gap:0.5rem; margin-bottom:1rem; }
        .tab { padding:0.6rem 1rem; background:#eef3f6; border-radius:4px; }
        .search { float:right; }
        table { width:100%; border-collapse:collapse; }
        th, td { padding:0.6rem; border-bottom:1px solid #eee; text-align:left; }
        .actions { display:flex; gap:0.5rem; }
        .btn { padding:0.4rem 0.7rem; border-radius:4px; text-decoration:none; color:#fff }
        .btn-edit { background:#4caf50 }
        .btn-delete { background:#d9534f }
    </style>
</head>
<body>
<div class="container">
    <h1>{{ title }}</h1>

    <div class="grid">
        <div class="col-left">
            <h3>Ajouter un Compte</h3>
            <form method="post" novalidate>
                {% csrf_token %}
                {% for field in form.visible_fields %}
                    <div class="form-row">
                        <label>{{ field.label_tag }}</label>
                        {{ field }}
                        {% if field.errors %}
                            <div class="errors">{{ field.errors }}</div>
                        {% endif %}
                    </div>
                {% endfor %}
                <div style="margin-top:0.8rem;"><button type="submit" class="btn btn-edit">Cr√©er le Compte</button></div>
            </form>
        </div>

        <div class="col-right">
            <div style="display:flex; align-items:center; justify-content:space-between;">
                <div class="tabs">
                    <a href="?role=librarian" class="tab">Biblioth√©caires</a>
                    <a href="?role=student" class="tab">√âtudiants</a>
                    <a href="?role=teacher" class="tab">Enseignants</a>
                    <a href="?role=all" class="tab">Tous</a>
                </div>
                <form method="get" class="search">
                    <input type="text" name="q" value="{{ q }}" placeholder="Rechercher...">
                    <button type="submit">üîé</button>
                </form>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Nom</th>
                        <th>Email</th>
                        <th>R√¥le</th>
                        <th>Date d'inscription</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in page_obj %}
                        <tr>
                            <td>{{ user.get_full_name|default:user.email }}</td>
                            <td>{{ user.email }}</td>
                            <td>{{ user.get_role_display }}</td>
                            <td>{{ user.created_at|date:"d.m.Y" }}</td>
                            <td class="actions">
                                <a class="btn btn-edit" href="{{ admin_change_url(user) }}">√âditer</a>
                                <a class="btn btn-delete" href="{{ admin_delete_url(user) }}">Supprimer</a>
                            </td>
                        </tr>
                    {% empty %}
                        <tr><td colspan="5">Aucun compte trouv√©.</td></tr>
                    {% endfor %}
                </tbody>
            </table>

            <div style="margin-top:1rem;">
                <span>Page {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>
                {% if page_obj.has_previous %}
                    <a href="?page={{ page_obj.previous_page_number }}{% if role %}&role={{ role }}{% endif %}{% if q %}&q={{ q }}{% endif %}">‚Üê</a>
                {% endif %}
                {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}{% if role %}&role={{ role }}{% endif %}{% if q %}&q={{ q }}{% endif %}">‚Üí</a>
                {% endif %}
            </div>
        </div>
    </div>
</div>
</body>
</html>
